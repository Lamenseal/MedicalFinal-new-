@model Medical.ViewModel.CMemberViewModel
@{
    ViewData["Title"] = "AdminMemberList";
    Layout = "~/Areas/Admin/Admin_Layout.cshtml";
}
<div class="btn btn-outline-secondary">
    <a asp-action="AdminCreate" class="fas fa-user-plus">新增會員</a>
</div>

<h1>會員資料管理頁面</h1>
<div class="col-md-3">
    <div>
        @using (Html.BeginForm())
        {
            @:關鍵字 @Html.TextBox("txtKeyword")
            <input type="submit" value="查詢" />
        }

        <a>權限篩選</a>

        @*下拉選單篩選，method="post" action="AdminMemberList"*@
        <form name="Role" method="post" action="AdminMemberList">
            <div class="form-group">
                <select asp-for="Role">
                    <option value="2">權限篩選</option>
                    @foreach (var item in Model.roleTypes)
                    {
                        <option value="@item.Role">@item.RoleName</option>
                    }
                </select>
                <input type="submit" value="篩選" class="btn btn-primary" />
            </div>
        </form>
    </div>
</div>





    <table class="table">
        <thead>
            <tr>
                <th>
                    序號
                </th>
                <th>
                    信箱
                </th>
                <th>
                    姓名
                </th>
                <th>
                    使用者ID
                </th>
                <th>
                    密碼
                </th>
                <th>
                    生日
                </th>
                <th>
                    性別
                </th>
                <th>
                    健保卡
                </th>
                <th>
                    電話
                </th>
                <th>
                    權限
                </th>
                <th>
                    城市
                </th>
                <th>
                    地址
                </th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            @{
                int count = 0;
                
                @foreach (var item in Model.mem)
                {
                    count++;

                    //前端篩選value=============================================================
                    var ro=Model.roleTypes.Where(t => t.Role == item.Role).Select(n => n.RoleName);  //篩選權限
                    string showRole = "";
                    foreach(var r in ro)
                    {
                        showRole = r;          //只會有一個
                    }
                    //========================
                    var gen = Model.MemGender.Where(t => t.GenderId == item.GenderId).Select(n => n.Gender1);
                    string showGen = "";
                    foreach(var g in gen)
                    {
                        showGen = g;
                    }
                    //========================
                    var ci = Model.MemCity.Where(t => t.CityId == item.CityId).Select(n => n.CityName);
                    string showCity = "";
                    foreach (var c in ci)
                    {
                        showCity = c;
                    }
                    //======================================================================
            <tr>
                <td>
                    @count
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Email)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.MemberName)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.IdentityId)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Password)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.BirthDay)
                </td>
                <td>
                    @showGen
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.IcCardNo)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Phone)
                </td>
                <td>
                    @showRole
                </td>
                <td>
                    @showCity
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Address)
                </td>
                <td>
                    @Html.ActionLink("", "Edit", "AdminMemberList", new { id = item.MemberId }, new { Class = "fas fa-edit" })
                    @Html.ActionLink("", "Delete", "AdminMemberList", new { id = item.MemberId }, new { onclick = "return confirm('確定要刪除資料嗎?')", Class = "fas fa-trash" })
                </td>
            </tr>
                }
            }
        </tbody>
    </table>

    <br />
    <br />
